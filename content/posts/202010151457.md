---
title: "202010151457"
date: 2020-10-15T14:57:25+08:00
draft: true
categories: [網頁製作]
tags: [NestJS]
---

<!--more-->
首先安裝nestjs/cli
```
# npm install -g @nestjs/cli
```
<br></br>

接下來建立Nest Project
```
$ nest new my-nest-app
...
? Which package manager would you ❤️  to use? npm
```
過程會提示要使用yarn或npm，個人是選擇npm
<br></br>

建立完的目錄樹狀圖，其實蠻簡潔的
```
src
    app.controller.spec.ts
    app.controller.ts
    app.module.ts
    app.service.ts
    main.ts
```
<br></br>

接下來試著run起來，start:dev後面的dev代表使用watch mode，檔案變更就會即時compile
```
$ npm run start:dev

...
[17:13:44] Starting compilation in watch mode...

[17:13:48] Found 0 errors. Watching for file changes.

[Nest] 1996   - 2020-10-15 17:13:49   [NestFactory] Starting Nest application...
[Nest] 1996   - 2020-10-15 17:13:49   [InstanceLoader] AppModule dependencies initialized +12ms
[Nest] 1996   - 2020-10-15 17:13:49   [RoutesResolver] AppController {/app}: +5ms
[Nest] 1996   - 2020-10-15 17:13:49   [RouterExplorer] Mapped {, GET} route +3ms
[Nest] 1996   - 2020-10-15 17:13:49   [NestApplication] Nest application successfully started +2ms
```
成功啟動，沒有提示listen port有點不貼心
<br></br>

listen設定在main.ts，預設為3000
```:src/main.ts {hl_lines=[6]}
import { NestFactory } from '@nestjs/core';
import { AppModule } from './app.module';

async function bootstrap() {
  const app = await NestFactory.create(AppModule);
  await app.listen(3000);
}
bootstrap();
```
<br></br>

連上localhost:3000看到hello world就是成功了
  
![](0.png)
<br></br>



hello world來自這個app.module
  
不只是decorator，裡面還有個熟悉的provider，風格真的很Angular，比較不一樣的是controller，畢竟是backend framework
```:src/app.module.ts
import { Module } from '@nestjs/common';
import { AppController } from './app.controller';
import { AppService } from './app.service';

@Module({
  imports: [],
  controllers: [AppController],
  providers: [AppService],
})
export class AppModule {}

```
<br></br>

request主要就是controller處理，不難看出和routing是一體的
```:src/app.controller.ts
import { Controller, Get } from '@nestjs/common';
import { AppService } from './app.service';

@Controller()
export class AppController {
  constructor(private readonly appService: AppService) {}

  @Get()
  getHello(): string {
    return this.appService.getHello();
  }
}
```
<br></br>

用範例比較好說明routing，如果改成下列的樣子，hello world的url就會變成localhost:3000/app/QAQ
```:src/app.controller.ts {hl_lines=[4, 8]}
import { Controller, Get } from '@nestjs/common';
import { AppService } from './app.service';

@Controller('app')
export class AppController {
  constructor(private readonly appService: AppService) {}

  @Get('QAQ')
  getHello(): string {
    return this.appService.getHello();
  }
}
