---
title: "從今天開始學Angular"
date: 2020-09-18T10:18:52+08:00
draft: true
categories: [網頁製作]
tags: [Angular, Node.js, TypeScript]
---
是時候多學幾個framework了…
<!--more-->
參考資料:
* [https://angular.io/docs](https://angular.io/docs)
* [https://qiita.com/aqlwah/items/f5d8c0430c5e0185bf88#%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9](https://qiita.com/aqlwah/items/f5d8c0430c5e0185bf88#%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9)

<br></br>

### 建立Project
---
<br></br>
首先安裝Angular CLI
```
# npm install -g @angular/cli
```
<br></br>
這樣就能使用Angular CLI的指令"ng"，這裡就直接建立一個project，stylesheet就選擇CSS好了，建立好之後就直接進入稍後要編集的目錄
```
$ ng new my-app

? Would you like to add Angular routing? Yes
? Which stylesheet format would you like to use?
> CSS

$ cd my-app
$ ng serve --open

...
** Angular Live Development Server is listening on localhost:4200, open your browser on http://localhost:4200/ **
: Compiled successfully.

Date: 2020-09-18T06:00:05.332Z - Hash: c048b12df6567723f106
5 unchanged chunks

Time: 1042ms
: Compiled successfully.
```
<br></br>
接下能就能到localhost:4200來看看編譯好的頁面
  
![](1.png)

<br></br>
要動的東西大多都在src，附上目錄的樹狀圖
```
src
│  favicon.ico
│  index.html
│  main.ts
│  polyfills.ts
│  styles.css
│  test.ts
│
├─app
│      app-routing.module.ts
│      app.component.css
│      app.component.html
│      app.component.spec.ts
│      app.component.ts
│      app.module.ts
│
├─assets
│      .gitkeep
│
└─environments
        environment.prod.ts
        environment.ts
```
<br></br>

### 建立Component
---
<br></br>
建立新的components，會產生下列檔案
```
$ ng generate component test
CREATE src/app/test/test.component.html (19 bytes)
CREATE src/app/test/test.component.spec.ts (612 bytes)
CREATE src/app/test/test.component.ts (267 bytes)     
CREATE src/app/test/test.component.css (0 bytes)      
UPDATE src/app/app.module.ts (537 bytes)
```
<br></br>
目錄看起來是這樣
```
...
│
└─test
        test.component.css
        test.component.html
        test.component.spec.ts
        test.component.ts
```
<br></br>
同時會自動在app.module.ts中import剛才建立的component
```:app/app.module.ts {hl_lines=[6, 11]}
import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';

import { AppRoutingModule } from './app-routing.module';
import { AppComponent } from './app.component';
import { TestComponent } from './test/test.component';

@NgModule({
  declarations: [
    AppComponent,
    TestComponent
  ],
  imports: [
    BrowserModule,
    AppRoutingModule
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }
```
<br></br>
而component長得像是這樣
```:app/test/test.component.ts {hl_lines=["3-7"]}
import { Component, OnInit } from '@angular/core';

@Component({
  selector: 'app-test',
  templateUrl: './test.component.html',
  styleUrls: ['./test.component.css']
})
export class TestComponent implements OnInit {

  constructor() { }

  ngOnInit(): void {
  }

}

```
selector的部分，也就是tag像這打的話就能指向component的內容
<br></br>
index.html預設是app-root，也就是剛才run的畫面，如果將index.html修改成下列這樣
```index.html {hl_lines=[11]}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>MyApp</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
  <app-test></app-test>
</body>
</html>
```
<br></br>
也將app.module.ts中的bootstrap array改成剛才建立的component
```:app/app.module.ts {hl_lines=[14]}
...
import { TestComponent } from './test/test.component';

@NgModule({
  declarations: [
    AppComponent,
    TestComponent
  ],
  imports: [
    BrowserModule,
    AppRoutingModule
  ],
  providers: [],
  bootstrap: [TestComponent]
})
export class AppModule { }
```
<br></br>
就會layout出TestComponent的template中的內容
![](2.png)
<br></br>

### 將Data在view中顯示
---
<br></br>
在component中定義一個變數，並在constructor()下給予一個值
```:app/test/test.component.ts {hl_lines=[3, 5]}
...
export class TestComponent implements OnInit {
  title: string;
  constructor() { 
    this.title = 'Hello, World!!';
  }

  ngOnInit(): void {
  }

}

```
<br></br>
再修改tamplete
```:app/test/test.component.html
<p>{{ title }}</p>
```
<br></br>
就能顯示剛才給予的值了
![](3.png)
<br></br>

### 建立Service
---
<br></br>
一樣能使用ng來建立service
```
$ ng generate service test
```
<br></br>
接著修改test.service.ts，以console.log測試
```:app/test.service.ts {hl_lines=[7]}
import { Injectable } from '@angular/core';

@Injectable({
  providedIn: 'root'
})
export class TestService {
  log(msg: any)   { console.log(msg); }
  constructor() { 
   }
}

```
<br></br>
service可以用以下方式使用
```:app/test/test.component.ts {hl_lines=[2, "12-14"]}
import { Component, OnInit } from '@angular/core';
import { TestService } from '../test.service';


@Component({
  selector: 'app-test',
  templateUrl: './test.component.html',
  styleUrls: ['./test.component.css'],
})
export class TestComponent implements OnInit {
  title: string;
  constructor(private Backend: TestService) { 
    this.title = 'Hello, World!';
    this.Backend.log(this.title);
  }

  ngOnInit(): void {
  }

}
```
<br></br>
值得注意的是service有階層化，若在@Injectable中，providedIn不是root的情形下，如範例
```:app/test.service.ts {hl_lines=[7]}
import { Injectable } from '@angular/core';

@Injectable({
  providedIn: null
})

...
```
<br></br>
則component要依賴service的話，必須要在providers指定service
```:app/test/test.component.ts {hl_lines=[9]}
import { Component, OnInit } from '@angular/core';
import { TestService } from '../test.service';


@Component({
  selector: 'app-test',
  templateUrl: './test.component.html',
  styleUrls: ['./test.component.css'],
  providers: [TestService]
})
```
<br></br>
未完待續…

