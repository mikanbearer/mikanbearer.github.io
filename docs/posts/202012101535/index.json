



    
        
    




{
  "result": {
    "content": "\u003cp\u003e久違的機器學習，身為資料分析\u0026amp;機器學習的超級新手(略)\u003c/p\u003e\n\u003cp\u003e這次練習的一樣是scikit-learn，主題就決定是k-近鄰演算法\u003c/p\u003e\n\u003cp\u003ek-近鄰演算法(k-nearest neighbors algorithm，簡稱k-NN)是一個用於分類和回歸的無母數統計方法，這次練習的分類器就是採用該演算法\u003c/p\u003e\n\u003cp\u003e以下節錄自\u003ca href=\"https://zh.wikipedia.org/zh-tw/K-%E8%BF%91%E9%82%BB%E7%AE%97%E6%B3%95\" target=\"_blank\"\u003e維基百科\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-text\" data-lang=\"text\"\u003e在k-NN分類中，輸出是一個分類族群。一個物件的分類是由其鄰居的「多數表決」確定的，\nk個最近鄰居（k為正整數，通常較小）中最常見的分類決定了賦予該物件的類別。\n若k = 1，則該物件的類別直接由最近的一個節點賦予。\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003ch3 id=\"載入資料集\"\u003e載入資料集\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n這次練習使用load_iris()，可以從DESCR查看詳細資料\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e sklearn.datasets \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e load_iris\n\n\niris \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e load_iris()\n\n\u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(iris\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ekeys())\n\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003edict_keys([\u0026#39;data\u0026#39;, \u0026#39;target\u0026#39;, \u0026#39;frame\u0026#39;, \u0026#39;target_names\u0026#39;, \u0026#39;DESCR\u0026#39;, \u0026#39;feature_names\u0026#39;, \u0026#39;filename\u0026#39;])\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\n\u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(iris\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDESCR)\n\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e.. _iris_dataset:\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eIris plants dataset\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e--------------------\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e**Data Set Characteristics:**\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    :Number of Instances: 150 (50 in each of three classes)\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    :Number of Attributes: 4 numeric, predictive attributes and the class\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    :Attribute Information:\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e        - sepal length in cm\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e        - sepal width in cm\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e        - petal length in cm\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e        - petal width in cm\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    ....\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003e把Data塞進pandas的DataFrame\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e pandas \u003cspan style=\"color:#f92672\"\u003eas\u003c/span\u003e pd\n\niris_data \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDataFrame(data\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eiris\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edata, columns\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eiris\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003efeature_names)\n\u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(iris_data\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehead())\n\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e   sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm)\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e0                5.1               3.5                1.4               0.2\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1                4.9               3.0                1.4               0.2\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e2                4.7               3.2                1.3               0.2\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e3                4.6               3.1                1.5               0.2\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e4                5.0               3.6                1.4               0.2\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\n\n\niris_target \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDataFrame(data\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eiris\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etarget)\n\u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(iris_target\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehead())\n\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e        0\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e0  setosa\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1  setosa\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e2  setosa\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e3  setosa\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e4  setosa\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003ch3 id=\"繪製散佈圖\"\u003e繪製散佈圖\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003e其實沒什麼意義，只是為了圖文並茂一下並藉此回味一下seaborn\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e seaborn \u003cspan style=\"color:#f92672\"\u003eas\u003c/span\u003e sns\n\n\u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003ematplotlib inline\n\niris_data[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;target\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e iris_target\n\nsns\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epairplot(iris_data, hue\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;target\u0026#39;\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n看看這次資料的分佈還滿錯縱複雜的\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"1.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003ch3 id=\"分割測試集與訓練集\"\u003e分割測試集與訓練集\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e sklearn.model_selection \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e train_test_split\n\n\nx_train, x_test, y_train, y_test \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e train_test_split(iris_data, iris_target, test_size\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.3\u003c/span\u003e)\n\n\u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(iris_data\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eshape)\n\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e(150, 4)\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\n\u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(x_train\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eshape)\n\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e(105, 4)\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\n\u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(x_test\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eshape)\n\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e(45, 4)\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003ch3 id=\"實施訓練\"\u003e實施訓練\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003e接下來就是前面說到的K Nearest Neighbor，分類器使用\u003ccode\u003eKNeighborsClassifier()\u003c/code\u003e，相關param可以參考\u003ca href=\"https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html\" target=\"_blank\"\u003e官方文件\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e這次練習的n_neighbors給1，也就是開頭敘述k-NN所指的常數k，這樣一來類別即是由最近的鄰居賦予\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e sklearn.neighbors \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e KNeighborsClassifier\n\n\nknn \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e KNeighborsClassifier(n_neighbors\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\nknn\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003efit(x_train, y_train\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evalues\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eravel())\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003ch3 id=\"評價與測試\"\u003e評價與測試\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003e塞進測試集\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e sklearn.metrics \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e confusion_matrix\n\n\ndf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDataFrame(confusion_matrix(y_test,knn\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epredict(x_test)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereshape(\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)))\ndf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003erename(columns\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003edict(zip(df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecolumns, [\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;(pre) \u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e name \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e name \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e iris\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etarget_names])), index\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003edict(zip(df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecolumns, iris\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etarget_names)))\ndf\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n出乎意料沒有預測錯誤的？\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"2.png\" alt=\"\"\u003e\n\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003e評價…不知怎麼這次有點準\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003eknn\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003escore(x_test, y_test)\n\n\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1.0\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e",
    "kind": "page",
    "params": {
      "categories": [
        "Machine Learning"
      ],
      "date": "2020-12-10T15:35:42+08:00",
      "draft": false,
      "iscjklanguage": true,
      "lastmod": "2020-12-10T15:35:42+08:00",
      "publishdate": "2020-12-10T15:35:42+08:00",
      "tags": [
        "Python",
        "scikit-learn"
      ],
      "title": "scikit-learn新手入門之k-近鄰演算法"
    },
    "permalink": "https://mikanbearer.github.io/posts/202012101535/index.json",
    "type": "posts",
    "wordcount": 735
  }
}