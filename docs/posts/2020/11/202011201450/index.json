



    
        
    




{
  "result": {
    "content": "\u003cp\u003e這次嘗試使用VNC來使用遠端桌面，感覺未來會用到所以先筆記一下\u003c/p\u003e\n\u003cp\u003e使用的是CentOS 7\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# cat /etc/*-release\nCentOS Linux release 7.7.1908 (Core)\nNAME=\u0026quot;CentOS Linux\u0026quot;\nVERSION=\u0026quot;7 (Core)\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003e如果沒GUI要先記得裝\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# yum groups install \u0026quot;GNOME Desktop\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003e安裝本次的主角TigerVNC，雖然上述的GNOME Desktop應該就有包含了\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# yum install -y tigervnc-server\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003e設定VNC密碼，之後就是用這密碼連線至指定的user\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# vncpasswd\nPassword:\nVerify:\nWould you like to enter a view-only password (y/n)? n\nA view-only password is not used\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003e使用vncserver指令建立一個session來連線\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# vncserver :1\nxauth:  file /root/.Xauthority does not exist\n\nNew 'node1:1 (root)' desktop is node1:1\n\nCreating default startup script /root/.vnc/xstartup\nCreating default config /root/.vnc/config\nStarting applications specified in /root/.vnc/xstartup\nLog file is /root/.vnc/node1:1.log\n\n# vncserver -list\n\nTigerVNC server sessions:\n\nX DISPLAY #     PROCESS ID\n:1              33094\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003e記得開通防火牆，port是5900+n，:1的話就是5901，:2就是5902，以此類推\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# firewall-cmd --permanent --add-port=5901/tcp\n# firewall-cmd --reload\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003e接下來就能用client連看看了，這裡用的是\u003ca target=\"_blank\" href=\"https://www.realvnc.com/en/\"\u003eRealVNC\u003c/a\u003e的VNC Viewer，首先新增連線\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"1.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003e點選之後會警告未加密，但對於測試來說無傷大雅\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"2.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003e輸入剛才的密碼就能看到GNOME的初始畫面\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"3.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003e建立\u003ccode\u003e/etc/systemd/system/vncserver@:1.service\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-service\" data-lang=\"service\"\u003e\u003cspan style=\"color:#66d9ef\"\u003e[Unit]\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003eDescription\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eRemote desktop service (VNC)\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003eAfter\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esyslog.target network.target\u003c/span\u003e\n\n\u003cspan style=\"color:#66d9ef\"\u003e[Service]\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003eType\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esimple\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003eUser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eroot\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003ePAMName\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003elogin\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003ePIDFile\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/root/.vnc/%H:%i.pid\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003eExecStartPre\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/bin/sh -c \u0026#39;/usr/bin/vncserver -kill %i \u0026gt; /dev/null 2\u0026gt;\u0026amp;1 || :\u0026#39;\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003eExecStart\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/usr/bin/vncserver -geometry 1440x900 -alwaysshared -fg %i\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003eExecStop\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/usr/bin/vncserver -kill %i\u003c/span\u003e\n\n\u003cspan style=\"color:#66d9ef\"\u003e[Install]\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003eWantedBy\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003emulti-user.target\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003eSELinux會擋所以就改一下，懶得重開就用\u003ccode\u003e# setenforce 0\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-:/etc/sysconfig/selinux\" data-lang=\":/etc/sysconfig/selinux\"\u003eSELINUX=permissive\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cp\u003e如此一來就service化了，可以設定開機自動啟動\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# systemctl daemon-reload\n# systemctl start vncserver@:1\n# systemctl enable vncserver@:1\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n感覺有了這個之後就有很多可玩\u003c/p\u003e",
    "kind": "page",
    "params": {
      "categories": [
        "Operation"
      ],
      "date": "2020-11-20T14:50:47+08:00",
      "draft": false,
      "iscjklanguage": true,
      "lastmod": "2020-11-20T14:50:47+08:00",
      "publishdate": "2020-11-20T14:50:47+08:00",
      "tags": [
        "TigerVNC"
      ],
      "title": "使用VNC遠端連線至CentOS"
    },
    "permalink": "https://mikanbearer.github.io/posts/2020/11/202011201450/index.json",
    "type": "posts",
    "wordcount": 526
  }
}