



    
        
    




{
  "result": {
    "content": "\u003cp\u003e這次實作目標是導入Flask-Login，讓咱們的app受驗證機制保護\u003c/p\u003e\n\u003cp\u003e完成的source code放在\u003ca target=\"_blank\" href=\"https://github.com/mikanbearer/flask_crud_example/releases/tag/append_login_page\"\u003e這裡\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e首先下載Flask-Login\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ pip install Flask-Login\r\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n因為原本測試的model就叫username了，為了避免混淆，login的user叫admin\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:app/app.py\" data-lang=\":app/app.py\"\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e flask_login\n\n\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\nlogin_manager \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e flask_login\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eLoginManager()\nlogin_manager\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003einit_app(app)\n\napp\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esecret_key \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eb\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;_5#y2L\u0026#34;F4Q8z\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\\xec\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e]/\u0026#39;\u003c/span\u003e\n\n\u003cspan style=\"color:#75715e\"\u003e#測試用的帳號\u003c/span\u003e\nadmins \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;testadmin\u0026#39;\u003c/span\u003e: {\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;password\u0026#39;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;123\u0026#39;\u003c/span\u003e}}\n\n\u003cspan style=\"color:#75715e\"\u003e#繼承自UserMixin\u003c/span\u003e\n\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eAdmin\u003c/span\u003e(flask_login\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eUserMixin):\n    \u003cspan style=\"color:#66d9ef\"\u003epass\u003c/span\u003e\n\n\n\u003cspan style=\"color:#75715e\"\u003e#存放session用\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003e@login_manager.user_loader\u003c/span\u003e\n\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003euser_loader\u003c/span\u003e(admin_name):\n    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e admin_name \u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e admins:\n        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\n    admin \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e Admin()\n    admin\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eid \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e admin_name\n    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e admin\n\n\n    admin \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e Admin()\n    admin\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eid \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e admin_name\n    admin\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eis_authenticated \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e request\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eform[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;password\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e admins[admin_name][\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;password\u0026#39;\u003c/span\u003e]\n\n    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e admin\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e這樣login_manager就能動了\n\u003cbr\u003e\u003c/br\u003e\n接下來加上decorator，就能測試動作了\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-py\" data-lang=\"py\"\u003e\u003cspan style=\"color:#a6e22e\"\u003e@app.route\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e)\n\u003cspan style=\"color:#a6e22e\"\u003e@flask_login.login_required\u003c/span\u003e\n\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elist\u003c/span\u003e():\n    users \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e User\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003equery\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eall()\n    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e render_template(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;list.html\u0026#39;\u003c/span\u003e, users\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eusers)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n\u003cimg style=\"display:inline;\" width=\"200\" src=\"1.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n可以使用@unauthorized_handler這個decorator，在Unauthorized時做自己想要的動作，比如redirect，下列的範例是導向回login\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:app/app.py\" data-lang=\":app/app.py\"\u003e\u003cspan style=\"color:#a6e22e\"\u003e@app.login_manager.unauthorized_handler\u003c/span\u003e\n\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eunauth\u003c/span\u003e():\n    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e redirect(url_for(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;login\u0026#39;\u003c/span\u003e))\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n接下來增加一個新的view，就是剛才提到的login\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:app/app.py\" data-lang=\":app/app.py\"\u003e\u003cspan style=\"color:#a6e22e\"\u003e@app.route\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;/login\u0026#39;\u003c/span\u003e, methods\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;GET\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;POST\u0026#39;\u003c/span\u003e])\n\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elogin\u003c/span\u003e():\n    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e request\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003emethod \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;POST\u0026#39;\u003c/span\u003e:\n        admin_name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e request\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eform[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;user\u0026#39;\u003c/span\u003e]\n        \u003cspan style=\"color:#66d9ef\"\u003etry\u003c/span\u003e:\n            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e request\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eform[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;password\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e admins[admin_name][\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;password\u0026#39;\u003c/span\u003e]:\n                admin \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e Admin()\n                admin\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eid \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e admin_name\n                flask_login\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elogin_user(admin)\n                \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e redirect(url_for(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;list\u0026#39;\u003c/span\u003e))\n        \u003cspan style=\"color:#66d9ef\"\u003eexcept\u003c/span\u003e:\n            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e render_template(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;login.html\u0026#39;\u003c/span\u003e, error\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Login Failed\u0026#39;\u003c/span\u003e)\n    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e render_template(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;login.html\u0026#39;\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e這樣子驗證不過的話，同樣會回到login，成功的話則重新導向到list\n\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:app/template/login.html\" data-lang=\":app/template/login.html\"\u003e\u003cspan style=\"color:#75715e\"\u003e\u0026lt;!doctype html\u0026gt;\u003c/span\u003e\n\u0026lt;\u003cspan style=\"color:#f92672\"\u003ehtml\u003c/span\u003e\u0026gt;\n  \u0026lt;\u003cspan style=\"color:#f92672\"\u003ehead\u003c/span\u003e\u0026gt;\n    \u0026lt;\u003cspan style=\"color:#f92672\"\u003elink\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003erel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;stylesheet\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ehref\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eintegrity\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecrossorigin\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;anonymous\u0026#34;\u003c/span\u003e\u0026gt;\n    \u0026lt;\u003cspan style=\"color:#f92672\"\u003etitle\u003c/span\u003e\u0026gt;Flask CRUD Example\u0026lt;/\u003cspan style=\"color:#f92672\"\u003etitle\u003c/span\u003e\u0026gt;\n  \u0026lt;/\u003cspan style=\"color:#f92672\"\u003ehead\u003c/span\u003e\u0026gt;\n  \u0026lt;\u003cspan style=\"color:#f92672\"\u003ebody\u003c/span\u003e\u0026gt;\n   \u0026lt;\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;container mt-4\u0026#34;\u003c/span\u003e\u0026gt;\n    \u0026lt;\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;row\u0026#34;\u003c/span\u003e\u0026gt;\n        \u0026lt;\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;col-12\u0026#34;\u003c/span\u003e\u0026gt;\n            \u0026lt;\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;card\u0026#34;\u003c/span\u003e\u0026gt;\n                \u0026lt;\u003cspan style=\"color:#f92672\"\u003eh5\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;card-header\u0026#34;\u003c/span\u003e\u0026gt;\n                    Login\n                \u0026lt;/\u003cspan style=\"color:#f92672\"\u003eh5\u003c/span\u003e\u0026gt;\n                \u0026lt;\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;card-body\u0026#34;\u003c/span\u003e\u0026gt;\n                    \u0026lt;\u003cspan style=\"color:#f92672\"\u003eform\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emethod\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;post\u0026#34;\u003c/span\u003e\u0026gt;\n                        \u0026lt;\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;form-group\u0026#34;\u003c/span\u003e\u0026gt;\n                            \u0026lt;\u003cspan style=\"color:#f92672\"\u003einput\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;text\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ename\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;user\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eplaceholder\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Username\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;form-control\u0026#34;\u003c/span\u003e\u0026gt;\n                        \u0026lt;/\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e\u0026gt;\n                        \u0026lt;\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;form-group\u0026#34;\u003c/span\u003e\u0026gt;\n                            \u0026lt;\u003cspan style=\"color:#f92672\"\u003einput\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;text\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ename\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;password\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eplaceholder\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Password\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;form-control\u0026#34;\u003c/span\u003e\u0026gt;\n                        \u0026lt;/\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e\u0026gt;\n                        \u0026lt;\u003cspan style=\"color:#f92672\"\u003ebutton\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;btn btn-primary\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;submit\u0026#34;\u003c/span\u003e\u0026gt;Submit\u0026lt;/\u003cspan style=\"color:#f92672\"\u003ebutton\u003c/span\u003e\u0026gt;\n                    \u0026lt;/\u003cspan style=\"color:#f92672\"\u003eform\u003c/span\u003e\u0026gt;\n                    {% if error %}\n                        {{ error }}\n                    {% endif %}\n                \u0026lt;/\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e\u0026gt;\n            \u0026lt;/\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e\u0026gt;\n        \u0026lt;/\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e\u0026gt;\n    \u0026lt;/\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e\u0026gt;\n\u0026lt;/\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e\u0026gt;\n  \u0026lt;/\u003cspan style=\"color:#f92672\"\u003ebody\u003c/span\u003e\u0026gt;\n  \u0026lt;\u003cspan style=\"color:#f92672\"\u003escript\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esrc\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https://code.jquery.com/jquery-3.2.1.slim.min.js\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eintegrity\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecrossorigin\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;anonymous\u0026#34;\u003c/span\u003e\u0026gt;\u0026lt;/\u003cspan style=\"color:#f92672\"\u003escript\u003c/span\u003e\u0026gt;\n  \u0026lt;\u003cspan style=\"color:#f92672\"\u003escript\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esrc\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eintegrity\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecrossorigin\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;anonymous\u0026#34;\u003c/span\u003e\u0026gt;\u0026lt;/\u003cspan style=\"color:#f92672\"\u003escript\u003c/span\u003e\u0026gt;\n  \u0026lt;\u003cspan style=\"color:#f92672\"\u003escript\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esrc\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eintegrity\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecrossorigin\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;anonymous\u0026#34;\u003c/span\u003e\u0026gt;\u0026lt;/\u003cspan style=\"color:#f92672\"\u003escript\u003c/span\u003e\u0026gt;\n\u0026lt;/\u003cspan style=\"color:#f92672\"\u003ehtml\u003c/span\u003e\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e到這裡login就算完成了\n\u003cbr\u003e\u003c/br\u003e\n接下來就是logout，這次做簡單一點，就直接導向回login\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:app/app.py\" data-lang=\":app/app.py\"\u003e\u003cspan style=\"color:#a6e22e\"\u003e@app.route\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;/logout\u0026#39;\u003c/span\u003e)\n\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elogout\u003c/span\u003e():\n    flask_login\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elogout_user()\n    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e redirect(url_for(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;login\u0026#39;\u003c/span\u003e))\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n接著在base.html上增加logout的按鈕\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\n\u003ctable style=\"border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;\"\u003e\u003ctr\u003e\u003ctd style=\"vertical-align:top;padding:0;margin:0;border:0;\"\u003e\n\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e21\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e22\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e23\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e24\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e25\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e26\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e27\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd style=\"vertical-align:top;padding:0;margin:0;border:0;;width:100%\"\u003e\n\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:app/templates/base.html\" data-lang=\":app/templates/base.html\"\u003e    \u0026lt;/\u003cspan style=\"color:#f92672\"\u003eul\u003c/span\u003e\u0026gt;\n\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e    {% if current_user.is_authenticated %}\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e      Hi, {{ current_user.id }}!\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e    \u0026lt;\u003cspan style=\"color:#f92672\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;btn btn-primary btn-sm ml-2\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003erole\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;button\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ehref\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e{{\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eurl_for\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e(\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003elogout\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;)\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e}}\u003c/span\u003e\u0026gt;Logout\u0026lt;/\u003cspan style=\"color:#f92672\"\u003ea\u003c/span\u003e\u0026gt;\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e    {% endif %}\n\u003c/span\u003e  \u0026lt;/\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e\u0026gt;\n\u0026lt;/\u003cspan style=\"color:#f92672\"\u003enav\u003c/span\u003e\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n再適當的用@flask_login.login_required來修飾其他的頁面，就能看看成果了\u003c/p\u003e\n\u003cimg style=\"display:inline;\" width=\"200\" src=\"2.png\"\u003e\r\n\u003cimg style=\"display:inline;\" width=\"200\" src=\"3.png\"\u003e\r\n\u003cp\u003e其實還不算太難看吧？\u003c/p\u003e",
    "kind": "page",
    "params": {
      "categories": [
        "Web Development"
      ],
      "date": "2020-09-14T12:57:20+08:00",
      "draft": false,
      "iscjklanguage": true,
      "lastmod": "2020-09-14T12:57:20+08:00",
      "publishdate": "2020-09-14T12:57:20+08:00",
      "tags": [
        "Flask",
        "Python"
      ],
      "title": "【Flask入門練習-CRUD篇3】使用Flask-Login實作登入畫面"
    },
    "permalink": "https://mikanbearer.github.io/posts/2020/09/202009141257/index.json",
    "type": "posts",
    "wordcount": 675
  }
}