



    
        
    




{
  "result": {
    "content": "\u003cp\u003e從爬蟲開始的實作，分析資料前總得先有資料吧(;\u0026lsquo;∀\u0026rsquo;)\u003c/p\u003e\n\u003cp\u003e作為資料分析的前置作業，就來爬取媒體最愛的PTT，畢竟BBS類型的資料還蠻標準的，雖然本人不太逛PTT就是了…\u003c/p\u003e\n\u003cp\u003e完成的souce code已放上github：\u003ca href=\"https://github.com/mikanbearer/scrapy_sample\"\u003ehttps://github.com/mikanbearer/scrapy_sample\u003c/a\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca onclick=\"window.scrollTo({top: document.getElementById(1).offsetTop, behavior: 'smooth'})\"\u003e使用Scrapy抓取資料\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca onclick=\"window.scrollTo({top: document.getElementById(2).offsetTop, behavior: 'smooth'})\"\u003e使用Matplotlib製圖\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca onclick=\"window.scrollTo({top: document.getElementById(3).offsetTop, behavior: 'smooth'})\"\u003e使用Jupyter Notebook\u003c/a\u003e\n\u003cbr\u003e\u003c/br\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"p-id1使用爬蟲抓取資料p\"\u003e\u003cp id=1\u003e使用爬蟲抓取資料\u003c/p\u003e\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e首先把環境部屬好\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ scrapy startproject scrapy_sample\r\n$ cd scrapy_sample/scrapy_sample/spiders\r\n$ scrapy genspider ptt_gossiping www.ptt.cc/bbs/Gossiping\r\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n編輯第一個spider，當然response是PTT確認年齡的頁面，之後要再改改\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\n\u003ctable style=\"border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;\"\u003e\u003ctr\u003e\u003ctd style=\"vertical-align:top;padding:0;margin:0;border:0;\"\u003e\n\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 1\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 2\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 3\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 4\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 5\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 6\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 7\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 8\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 9\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd style=\"vertical-align:top;padding:0;margin:0;border:0;;width:100%\"\u003e\n\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:scrapy_sample/spiders/ptt_gossiping.py\" data-lang=\":scrapy_sample/spiders/ptt_gossiping.py\"\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e scrapy\n\n\n\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePttGossipingSpider\u003c/span\u003e(scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSpider):\n    name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ptt_gossiping\u0026#39;\u003c/span\u003e\n    allowed_domains \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;www.ptt.cc/bbs/Gossiping\u0026#39;\u003c/span\u003e]\n    start_urls \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;http://www.ptt.cc/bbs/Gossiping\u0026#39;\u003c/span\u003e]\n\n    \u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eparse\u003c/span\u003e(self, response):\n        \u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etext)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n可以從source code得知年齡確認用了一個form，會post兩種value，yes和no，現在就就直接post了，省時省力\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\n\u003ctable style=\"border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;\"\u003e\u003ctr\u003e\u003ctd style=\"vertical-align:top;padding:0;margin:0;border:0;\"\u003e\n\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 1\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 2\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 3\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 4\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 5\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 6\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 7\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 8\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 9\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e10\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e11\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e12\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e13\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e14\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e15\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e16\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e17\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e18\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd style=\"vertical-align:top;padding:0;margin:0;border:0;;width:100%\"\u003e\n\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:scrapy_sample/spiders/ptt_gossiping.py\" data-lang=\":scrapy_sample/spiders/ptt_gossiping.py\"\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e scrapy\n\n\n\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePttGossipingSpider\u003c/span\u003e(scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSpider):\n    name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ptt_gossiping\u0026#39;\u003c/span\u003e\n    allowed_domains \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;www.ptt.cc/bbs/Gossiping\u0026#39;\u003c/span\u003e]\n    start_urls \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;http://www.ptt.cc/bbs/Gossiping\u0026#39;\u003c/span\u003e]\n\n\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e    \u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eparse\u003c/span\u003e(self, response):\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eFormRequest\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003efrom_response(\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e            response,\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e            formdata\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e{\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;yes\u0026#39;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;yes\u0026#39;\u003c/span\u003e},\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e            callback\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eself\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eafter_ask,\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e            dont_filter\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eTrue\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e        )\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e    \u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eafter_ask\u003c/span\u003e(self, response):\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e        \u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etext)\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n再來就要開始換頁，把spider改成這樣，頁是最好先限制一下，不然好幾萬頁有點吃不消\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\n\u003ctable style=\"border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;\"\u003e\u003ctr\u003e\u003ctd style=\"vertical-align:top;padding:0;margin:0;border:0;\"\u003e\n\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 1\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 2\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 3\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 4\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 5\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 6\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 7\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 8\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 9\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e10\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e11\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e12\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e13\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e14\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e15\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e16\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e17\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e18\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e19\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e20\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e21\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e22\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e23\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e24\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e25\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e26\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e27\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e28\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd style=\"vertical-align:top;padding:0;margin:0;border:0;;width:100%\"\u003e\n\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:scrapy_sample/spiders/ptt_gossiping.py\" data-lang=\":scrapy_sample/spiders/ptt_gossiping.py\"\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e scrapy\n\n\n\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePttGossipingSpider\u003c/span\u003e(scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSpider):\n    name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ptt_gossiping\u0026#39;\u003c/span\u003e\n    allowed_domains \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;www.ptt.cc/bbs/Gossiping\u0026#39;\u003c/span\u003e]\n    start_urls \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;http://www.ptt.cc/bbs/Gossiping\u0026#39;\u003c/span\u003e]\n\n\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e    max_page \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e#最大頁數\u003c/span\u003e\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e    page_count \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e#計數用\u003c/span\u003e\n\u003c/span\u003e\n    \u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eparse\u003c/span\u003e(self, response):\n        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eFormRequest\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003efrom_response(\n            response,\n            formdata\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e{\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;yes\u0026#39;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;yes\u0026#39;\u003c/span\u003e},\n            callback\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eself\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eafter_ask,\n            dont_filter\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eTrue\n        )\n\n    \u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eafter_ask\u003c/span\u003e(self, response):\n\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epage_count \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003emax_page:\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e            next \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003expath(\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;//div[@id=\u0026#34;action-bar-container\u0026#34;]//a[contains(text(), \u0026#34;上頁\u0026#34;)]/@href\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(default\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eNone) \u003cspan style=\"color:#75715e\"\u003e#抓innertext為\u0026#34;上頁\u0026#34;的element\u003c/span\u003e\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e next:\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e                url \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eurljoin(next)\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e                \u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(url)\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e                self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epage_count \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e                \u003cspan style=\"color:#66d9ef\"\u003eyield\u003c/span\u003e scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRequest(url\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eurl, callback\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eself\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eafter_ask, dont_filter\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eTrue) \u003cspan style=\"color:#75715e\"\u003e#再call一次after_ask\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n接下來再小小修改一下after_ask()，使用一個for來多開幾個Reuqest，callback為parse_post\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\n\u003ctable style=\"border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;\"\u003e\u003ctr\u003e\u003ctd style=\"vertical-align:top;padding:0;margin:0;border:0;\"\u003e\n\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e20\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e21\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e22\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e23\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e24\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e25\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e26\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e27\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e28\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e29\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e30\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e31\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd style=\"vertical-align:top;padding:0;margin:0;border:0;;width:100%\"\u003e\n\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:scrapy_sample/spiders/ptt_gossiping.py\" data-lang=\":scrapy_sample/spiders/ptt_gossiping.py\"\u003e    \u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eafter_ask\u003c/span\u003e(self, response):\n\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e        \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e href \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecss(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;div.r-ent div.title a::attr(href)\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egetall():\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e            url \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eurljoin(href)\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e            \u003cspan style=\"color:#66d9ef\"\u003eyield\u003c/span\u003e scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRequest(url\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eurl, callback\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eself\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eparse_post, dont_filter\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eTrue)\n\u003c/span\u003e\n        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epage_count \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003emax_page:\n            next \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003expath(\n                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;//div[@id=\u0026#34;action-bar-container\u0026#34;]//a[contains(text(), \u0026#34;上頁\u0026#34;)]/@href\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(default\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eNone)\n            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e next:\n                self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epage_count \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n                url \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eurljoin(next)\n                \u003cspan style=\"color:#66d9ef\"\u003eyield\u003c/span\u003e scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eRequest(url\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eurl, callback\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eself\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eafter_ask, dont_filter\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eTrue)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n先定義這個簡單的function，就能看到response.url是個標題的網址，如此一來就可以開始抓內容了\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-py\" data-lang=\"py\"\u003e    \u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eparse_post\u003c/span\u003e(self, response):\n        \u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eurl)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n準備好items\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\n\u003ctable style=\"border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;\"\u003e\u003ctr\u003e\u003ctd style=\"vertical-align:top;padding:0;margin:0;border:0;\"\u003e\n\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 1\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 2\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 3\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 4\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 5\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 6\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 7\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 8\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e 9\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e10\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e11\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd style=\"vertical-align:top;padding:0;margin:0;border:0;;width:100%\"\u003e\n\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:scrapy_sample/items.py\" data-lang=\":scrapy_sample/items.py\"\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e scrapy\n\n\n\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePostItem\u003c/span\u003e(scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eItem):\n    url \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eField()\n    title \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eField()\n    author \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eField()\n    date \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eField()\n    content \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eField()\n    comments \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eField()\n    score \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e scrapy\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eField()\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n接下來回到spider，修改成下列的樣子就差不多大功告成\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\n\u003ctable style=\"border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;\"\u003e\u003ctr\u003e\u003ctd style=\"vertical-align:top;padding:0;margin:0;border:0;\"\u003e\n\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e35\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e36\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e37\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e38\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e39\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e40\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e41\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e42\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e43\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e44\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e45\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e46\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e47\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e48\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e49\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e50\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e51\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e52\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e53\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e54\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e55\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e56\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e57\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e58\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e59\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e60\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e61\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e62\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e63\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e64\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e65\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e66\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e67\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e68\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e69\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e70\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e71\n\u003c/span\u003e\u003cspan style=\"margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f\"\u003e72\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd style=\"vertical-align:top;padding:0;margin:0;border:0;;width:100%\"\u003e\n\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:scrapy_sample/spiders/ptt_gossiping.py\" data-lang=\":scrapy_sample/spiders/ptt_gossiping.py\"\u003e    \u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eparse_post\u003c/span\u003e(self, response):\n        item \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e PostItem()\n        item[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;title\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecss(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;meta[property=\u0026#34;og:title\u0026#34;]::attr(content)\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget()\n        item[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;author\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003expath(\n            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;//div[@class=\u0026#34;article-metaline\u0026#34;]/span[text()=\u0026#34;作者\u0026#34;]/following-sibling::span[1]/text()\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esplit(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e)[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]\n\n        datetime_str \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003expath(\n            \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;//div[@class=\u0026#34;article-metaline\u0026#34;]/span[text()=\u0026#34;時間\u0026#34;]/following-sibling::span[1]/text()\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget()\n        item[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;date\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e datetime\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estrptime(datetime_str, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;%a %b \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e%d\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e %H:%M:%S %Y\u0026#39;\u003c/span\u003e)\n        item[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;content\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecss(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;div#main-content::text\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget()\n        comments \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e []\n        score_total \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\n        \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e comment \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecss(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;div.push\u0026#39;\u003c/span\u003e):\n            tag \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e comment\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecss(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;span.push-tag::text\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget()\n            user \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e comment\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecss(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;span.push-userid::text\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget()\n            content \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e comment\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecss(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;span.push-content::text\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget()\n\n            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;推\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e tag:\n                score \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n            \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;噓\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e tag:\n                score \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n            \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e:\n                score \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\n            score_total \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e score\n\n            comments\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eappend({\n                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;user\u0026#39;\u003c/span\u003e: user,\n                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;score\u0026#39;\u003c/span\u003e: score,\n                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;content\u0026#39;\u003c/span\u003e: content\n            })\n\n        item[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;comments\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e comments\n        item[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;score\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e score_total\n        item[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;url\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e response\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eurl\n\n        \u003cspan style=\"color:#66d9ef\"\u003eyield\u003c/span\u003e item\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n完成輸入指令，就能看到貼文被抓下來啦\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ scrapy crawl ptt_gossiping -o test.json\r\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e遲來的資料分析，原本想通通和爬蟲一起塞一篇，但一次做太多自己沒辦法進入狀況，只好先練習資料可視化開始熟悉手邊工具，之後再循序漸進繼續深入\u003c/p\u003e\n\u003c!--more--\u003e\r\n\u003cp\u003e這篇比較有點過渡期的味道，畢竟沒有太多內容，所以就索性加了一點點Jupyter notebook\u003c/p\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n練習的檔案，是用之前抓的PTT貼文\n\u003ca href=\"https://github.com/mikanbearer/scrapy_sample\"\u003ehttps://github.com/mikanbearer/scrapy_sample\u003c/a\u003e\n\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003ch3 id=\"p-id2使用matplotlib製圖p\"\u003e\u003cp id=2\u003e使用Matplotlib製圖\u003c/p\u003e\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n首先用pip下載需要用的包\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ pip install matplotlib\r\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n接下來將json做個簡單的處理\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-py\" data-lang=\"py\"\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e json\n\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e collections \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e defaultdict\n\n\u003cspan style=\"color:#66d9ef\"\u003ewith\u003c/span\u003e open(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;pttgossip.json\u0026#39;\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eas\u003c/span\u003e f:\n    posts \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e json\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eload(f) \u003cspan style=\"color:#75715e\"\u003e#讀取練習的jason\u003c/span\u003e\n\n\u003cspan style=\"color:#75715e\"\u003e#建立defaultdict物件，value type為int\u003c/span\u003e\ncomments_total \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e defaultdict(int)\npushes_total \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e defaultdict(int)\nhates_total \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e defaultdict(int)\n\n\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e post \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e posts:\n    \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e comment \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e post[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;comments\u0026#39;\u003c/span\u003e]:\n        user \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e comment[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;user\u0026#39;\u003c/span\u003e]\n\n        comments_total[user] \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\n        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e comment[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;score\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e:\n            pushes_total[user] \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\n        \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e comment[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;score\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e:\n            hates_total[user] \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e這樣就能以user為key，value則是一個count\n\u003cbr\u003e\u003c/br\u003e\n接著可以畫圖囉，以user為x，那麼回應、推、噓三個則為y值，以這構想大概這樣做\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-py\" data-lang=\"py\"\u003e\u003cspan style=\"color:#75715e\"\u003e#以comment數來排序成user list，長度取50\u003c/span\u003e\nsorted_users \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [item[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e] \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e item \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e sorted(comments_total\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eitems(), key\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elambda\u003c/span\u003e x: \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ex[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e])][:]\n\u003cspan style=\"color:#75715e\"\u003e#以user list來排序回覆count\u003c/span\u003e\ny_comments \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [comments_total[u] \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e u \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e sorted_users]\n\u003cspan style=\"color:#75715e\"\u003e#以user list來排序推文count\u003c/span\u003e\ny_pushes \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [pushes_total[u] \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e u \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e sorted_users]\n\u003cspan style=\"color:#75715e\"\u003e#以user list來排序噓文count\u003c/span\u003e\ny_hates \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [hates_total[u] \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e u \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e sorted_users]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e這樣就處理好x與三個y\n\u003cbr\u003e\u003c/br\u003e\n接下來就能用mtatplotlib產生簡單的圖\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-py\" data-lang=\"py\"\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e matplotlib.pyplot \u003cspan style=\"color:#f92672\"\u003eas\u003c/span\u003e plt\n\n\n\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecomment_graph\u003c/span\u003e(comments, pushes, hates, max_x):\n    sorted_users \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [item[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e] \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e item \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e sorted(comments\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eitems(), key\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elambda\u003c/span\u003e x: \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ex[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e])][:max_x]\n    y_comments \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [comments[u] \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e u \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e sorted_users]\n    y_pushes \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [pushes[u] \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e u \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e sorted_users]\n    y_hates \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [hates[u] \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e u \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e sorted_users]\n\n    x \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range(len(sorted_users))\n\n    plt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eplot(x, y_comments, color\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;blue\u0026#39;\u003c/span\u003e, label\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;comments\u0026#39;\u003c/span\u003e)\n    plt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eplot(x, y_pushes, color\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;green\u0026#39;\u003c/span\u003e, label\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;pushes\u0026#39;\u003c/span\u003e)\n    plt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eplot(x, y_hates, color\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;red\u0026#39;\u003c/span\u003e, label\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;hates\u0026#39;\u003c/span\u003e)\n    plt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elegend()\n    plt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eshow()\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n最後完成的code如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-py\" data-lang=\"py\"\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e json\n\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e collections \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e defaultdict\n\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e matplotlib.pyplot \u003cspan style=\"color:#f92672\"\u003eas\u003c/span\u003e plt\n\n\u003cspan style=\"color:#66d9ef\"\u003ewith\u003c/span\u003e open(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;pttgossip.json\u0026#39;\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eas\u003c/span\u003e f:\n    posts \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e json\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eload(f)\n\ncomments_total \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e defaultdict(int)\npushes_total \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e defaultdict(int)\nhates_total \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e defaultdict(int)\n\n\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e post \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e posts:\n    \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e comment \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e post[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;comments\u0026#39;\u003c/span\u003e]:\n        user \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e comment[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;user\u0026#39;\u003c/span\u003e]\n        comments_total[user] \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\n        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e comment[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;score\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e:\n            pushes_total[user] \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\n        \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e comment[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;score\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e:\n            hates_total[user] \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\n\n\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecomment_graph\u003c/span\u003e(comments, pushes, hates, max_x):\n    sorted_users \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [item[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e] \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e item \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e sorted(comments\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eitems(), key\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elambda\u003c/span\u003e x: \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003ex[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e])][:max_x]\n    y_comments \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [comments[u] \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e u \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e sorted_users]\n    y_pushes \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [pushes[u] \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e u \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e sorted_users]\n    y_hates \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [hates[u] \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e u \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e sorted_users]\n\n    x \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e range(len(sorted_users))\n\n    plt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eplot(x, y_comments, color\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;blue\u0026#39;\u003c/span\u003e, label\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;comments\u0026#39;\u003c/span\u003e)\n    plt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eplot(x, y_pushes, color\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;green\u0026#39;\u003c/span\u003e, label\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;pushes\u0026#39;\u003c/span\u003e)\n    plt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eplot(x, y_hates, color\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;red\u0026#39;\u003c/span\u003e, label\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;hates\u0026#39;\u003c/span\u003e)\n    plt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elegend()\n    plt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etitle(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;total comments\u0026#39;\u003c/span\u003e)\n    plt\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eshow()\n\ncomment_graph(comments_total, pushes_total, hates_total, \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n這樣就能看到前幾名回應活躍的user了\n\u003cimg src=\"1.png\" alt=\"\"\u003e\n\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003ch3 id=\"p-id3使用jupyter-notebookp\"\u003e\u003cp id=3\u003e使用Jupyter Notebook\u003c/p\u003e\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n畢竟要做資料練習，果然還是有個shell一般的操作方式最好吧？可用又可讀，如同IPython notebook，但這次來用用Jupyter\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ pip install ipython jupyter\r\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n輸入指令啟動notebook\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ jupyter notebook\r\n...\r\n[I 09:56:21.690 NotebookApp] Jupyter Notebook 6.1.3 is running at:\r\n[I 09:56:21.690 NotebookApp] http://localhost:8888/?token=389282ffb93c1426ba34e094ef8b8667ad6812ad8575a0f6\r\n[I 09:56:21.691 NotebookApp]  or http://127.0.0.1:8888/?token=389282ffb93c1426ba34e094ef8b8667ad6812ad8575a0f6\r\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003cbr\u003e\n接下來開啟帶有token的網址，把要分析的json上傳\n\u003cimg src=\"4.png\" alt=\"\"\u003e\n\u003cbr\u003e\u003c/br\u003e\n接著建立新的Pyhon3 Notebook\n\u003cimg src=\"5.png\" alt=\"\"\u003e\n\u003cbr\u003e\u003c/br\u003e\n接下來就能進入notebook操作了\n\u003cimg src=\"6.png\" alt=\"\"\u003e\n\u003cbr\u003e\u003c/br\u003e\n加上下列就能將圖片inline顯示\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e%matplotlib notebook\r\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\nrun完結果範例就像是這樣\n\u003cimg src=\"7.png\" alt=\"\"\u003e\n\u003cbr\u003e\u003c/br\u003e\nnotebook也能以.ipynb以外的格式download下來用其他工具閱讀\n\u003cimg src=\"8.png\" alt=\"\"\u003e\n完成的notebook(.ipynb)放在\u003ca href=\"https://github.com/mikanbearer/scrapy_sample/blob/master/notebook1.ipynb\"\u003e這裡\u003c/a\u003e可直接觀看喔\u003c/p\u003e",
    "kind": "page",
    "params": {
      "categories": [
        "WebCrawler"
      ],
      "date": "2020-09-07T09:54:48+08:00",
      "draft": false,
      "iscjklanguage": true,
      "lastmod": "2020-09-07T09:54:48+08:00",
      "publishdate": "2020-09-07T09:54:48+08:00",
      "tags": [
        "Matplotlib",
        "Python",
        "Scrapy"
      ],
      "title": "【Python資料分析練習-入門篇1】使用Scrapy爬取PTT貼文"
    },
    "permalink": "https://mikanbearer.github.io/posts/2020/09/202009070954/index.json",
    "type": "posts",
    "wordcount": 2286
  }
}