<p>計畫使用Hugo來製作Single Page，有JSON會方便很多，許多地方寫得不是很清楚所以筆記一下</p>
<p>首先是在config.toml增加下列設定，也就是kind後面放上想輸出的格式</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-:config.toml" data-lang=":config.toml">...
[<span style="color:#a6e22e">outputs</span>]
  <span style="color:#a6e22e">page</span> = [<span style="color:#e6db74">&#34;HTML&#34;</span>, <span style="color:#e6db74">&#34;JSON&#34;</span>]
</code></pre></div><p>為了簡化所以範例只使用page，其他kind如同home、section、taxonamy或term其實大同小異
<br></br>
run起來會很貼心的警告沒有template</p>
<pre><code>WARN 2020/10/11 15:35:48 found no layout file for &quot;JSON&quot; for kind &quot;page&quot;: You should create a template file which matches Hugo Layouts Lookup Rules for this combination.
</code></pre><p><br></br>
接下來就建立template，因為是page所以template名為single，section的話就是list，以此類推</p>
<pre><code>│  404.html
│  index.html
│
├─partials
│     footer.html
│     head.html
│     header.html
│
├─posts
│      single.html
│      single.json ★
│
└─_default
        baseof.html
        baseof.json ★
        list.html
        single.html
</code></pre><p><br></br>
仿造baseof.html的baseof.json，含result這個key</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-:_default/baseof.json" data-lang=":_default/baseof.json">{
    <span style="color:#f92672">&#34;result&#34;</span> : {<span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#960050;background-color:#1e0010">block</span> <span style="color:#f92672">&#34;result&#34;</span> <span style="color:#960050;background-color:#1e0010">.</span>}}{<span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#960050;background-color:#1e0010">end</span> }<span style="color:#960050;background-color:#1e0010">}</span>
<span style="color:#960050;background-color:#1e0010">}</span>
</code></pre></div><p><br></br>
主角的single.json，如此一來single.json內的block就會包進baseof輸出</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-posts/single.json" data-lang="posts/single.json">{<span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#960050;background-color:#1e0010">define</span> <span style="color:#f92672">&#34;result&#34;</span> }<span style="color:#960050;background-color:#1e0010">}</span>
{
    <span style="color:#f92672">&#34;title&#34;</span>: <span style="color:#e6db74">&#34;{{ .Title }}&#34;</span>,
    <span style="color:#f92672">&#34;date&#34;</span>: <span style="color:#e6db74">&#34;{{ .Date.Format &#34;</span><span style="color:#ae81ff">2006-01-02</span> <span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">04</span><span style="color:#e6db74">&#34; }}&#34;</span>,
    <span style="color:#f92672">&#34;draft&#34;</span>: <span style="color:#e6db74">&#34;{{ .Draft }}&#34;</span>,
    <span style="color:#f92672">&#34;categories&#34;</span>: 
    [
        {<span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#960050;background-color:#1e0010">range</span> <span style="color:#960050;background-color:#1e0010">$i,</span> <span style="color:#960050;background-color:#1e0010">$e</span> <span style="color:#960050;background-color:#1e0010">:=</span> <span style="color:#960050;background-color:#1e0010">.Params.Categories</span> }<span style="color:#960050;background-color:#1e0010">}</span>
            {<span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#960050;background-color:#1e0010">if</span> <span style="color:#960050;background-color:#1e0010">$i</span> }<span style="color:#960050;background-color:#1e0010">}</span>, {<span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#960050;background-color:#1e0010">end</span> }<span style="color:#960050;background-color:#1e0010">}</span><span style="color:#e6db74">&#34;{{ $e }}&#34;</span>
        {<span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#960050;background-color:#1e0010">end</span> }<span style="color:#960050;background-color:#1e0010">}</span>
    ],
    <span style="color:#f92672">&#34;tags&#34;</span>:
    [
        {<span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#960050;background-color:#1e0010">range</span> <span style="color:#960050;background-color:#1e0010">$i,</span> <span style="color:#960050;background-color:#1e0010">$e</span> <span style="color:#960050;background-color:#1e0010">:=</span> <span style="color:#960050;background-color:#1e0010">.Params.Tags</span> }<span style="color:#960050;background-color:#1e0010">}</span>
            {<span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#960050;background-color:#1e0010">if</span> <span style="color:#960050;background-color:#1e0010">$i</span> }<span style="color:#960050;background-color:#1e0010">}</span>, {<span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#960050;background-color:#1e0010">end</span> }<span style="color:#960050;background-color:#1e0010">}</span><span style="color:#e6db74">&#34;{{ $e }}&#34;</span>
        {<span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#960050;background-color:#1e0010">end</span> }<span style="color:#960050;background-color:#1e0010">}</span>
    ],

    <span style="color:#f92672">&#34;url&#34;</span>: <span style="color:#e6db74">&#34;{{ .Permalink }}&#34;</span>
}
{<span style="color:#960050;background-color:#1e0010">{</span> <span style="color:#960050;background-color:#1e0010">end</span> }<span style="color:#960050;background-color:#1e0010">}</span>
</code></pre></div><p><br></br>
輸出後會在目錄下產生index.json，內容像是這個樣子，如此一來就大功告成了</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-:posts/202009221717/index.json" data-lang=":posts/202009221717/index.json">{
    <span style="color:#f92672">&#34;result&#34;</span> : 
{
    <span style="color:#f92672">&#34;title&#34;</span>: <span style="color:#e6db74">&#34;讓Hugo輸出JSON格式&#34;</span>,
    <span style="color:#f92672">&#34;date&#34;</span>: <span style="color:#e6db74">&#34;2020-09-22 17:17&#34;</span>,
    <span style="color:#f92672">&#34;draft&#34;</span>: <span style="color:#e6db74">&#34;true&#34;</span>,
    <span style="color:#f92672">&#34;categories&#34;</span>: 
    [
        
            <span style="color:#e6db74">&#34;網頁製作&#34;</span>
        
    ],
    <span style="color:#f92672">&#34;tags&#34;</span>:
    [
        
            <span style="color:#e6db74">&#34;Hugo&#34;</span>
        
    ],

    <span style="color:#f92672">&#34;url&#34;</span>: <span style="color:#e6db74">&#34;http://localhost:1313/posts/2020/09/202009221717/&#34;</span>
}

}
</code></pre></div><p><br></br>
比較需要注意的是內容很容易parse error…</p>