



    
        
    




{
  "result": {
    "content": "\u003cp\u003e雖然久仰Ansible大名，但總是停留在紙上談兵的階段，這次就先練習一遍，熟悉點再來自己寫role\u003c/p\u003e\n\u003cp\u003e\u003ca target=\"_blank\" href=\"https://docs.ansible.com/\"\u003e參考文件\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e本次環境用四台VM，分別是\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDebian 9.7(Controller)：192.168.149.130\u003c/li\u003e\n\u003cli\u003eDebian 9.7(Target) * 2：192.168.149.131 .133\u003c/li\u003e\n\u003cli\u003eCentOS 7.7(Ansible Target)：192.168.149.132\n\u003cbr\u003e\u003c/br\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e首先來安裝最新版的Ansible\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# echo 'deb http://ppa.launchpad.net/ansible/ansible/ubuntu trusty main' \u0026gt;\u0026gt; /etc/apt/sources.list\r\n# apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 93C4A3FD7BB9C367\r\n# apt update\r\n# apt install ansible\r\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n確認一下版本\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ ansible --version\r\nansible 2.9.13\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/dist-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.13 (default, Sep 26 2018, 18:42:22) [GCC 6.3.0 20170516]\r\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n首先使用ping module試試\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ ansible all -m ping\r\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\r\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e會很貼心地說hosts是空的，值得議題的是，implicit的group會有兩種，一個是\u003ccode\u003eall\u003c/code\u003e，另一個則是\u003ccode\u003eungrouped\u003c/code\u003e，兩者皆不會匹配到localhost\n\u003cbr\u003e\u003c/br\u003e\n那就指定成localhost\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ ansible localhost -m ping\r\nlocalhost | SUCCESS =\u0026gt; {\r\n    \u0026quot;changed\u0026quot;: false, \r\n    \u0026quot;ping\u0026quot;: \u0026quot;pong\u0026quot;\r\n}\r\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e就可以看到ping成功的訊息了\n\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003ch3 id=\"設定inventory\"\u003e設定Inventory\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n接下來就是建立自己的inventory，預設的ansible目錄是這樣\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e/etc/ansible/\r\n├── ansible.cfg\r\n├── hosts\r\n└── roles\r\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n而這次要修改的就是這個\u003cstrong\u003ehosts\u003c/strong\u003e，host的格式可使用INI和YAML，而這次練習用了這三個變數\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eansible_user → 登入帳號\u003c/li\u003e\n\u003cli\u003eansible_password → 登入密碼(不使用key的時候採用的)\u003c/li\u003e\n\u003cli\u003eansible_python_interpreter → 檢查target的interpreter\nINI範例：\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-INI\" data-lang=\"INI\"\u003e\u003cspan style=\"color:#66d9ef\"\u003e[group1]\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003e192.168.149.131\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003e192.168.149.133\u003c/span\u003e\n\n\u003cspan style=\"color:#66d9ef\"\u003e[group1:vars]\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003eansible_user\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eabc\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003eansible_password\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e123\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003eansible_python_interpreter\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eauto_legacy_silent\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\nYAML範例：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-YAML\" data-lang=\"YAML\"\u003e\u003cspan style=\"color:#f92672\"\u003eall\u003c/span\u003e:\n  \u003cspan style=\"color:#f92672\"\u003echildren\u003c/span\u003e:\n    \u003cspan style=\"color:#f92672\"\u003egroup1\u003c/span\u003e:\n      \u003cspan style=\"color:#f92672\"\u003ehosts\u003c/span\u003e:\n        \u003cspan style=\"color:#f92672\"\u003e192.168.149.131\u003c/span\u003e:\n        \u003cspan style=\"color:#f92672\"\u003e192.168.149.133\u003c/span\u003e:\n      \u003cspan style=\"color:#f92672\"\u003evars\u003c/span\u003e:\n        \u003cspan style=\"color:#f92672\"\u003eansible_user\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eabc\u003c/span\u003e\n        \u003cspan style=\"color:#f92672\"\u003eansible_password\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e123\u003c/span\u003e\n        \u003cspan style=\"color:#f92672\"\u003eansible_python_interpreter\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eauto_legacy_silent\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n使用YAML的話，最底層必須是all，像以下範例的話，一台host會列為\u003ccode\u003eungrouped\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-YAML\" data-lang=\"YAML\"\u003e\u003cspan style=\"color:#f92672\"\u003eall\u003c/span\u003e:\n  \u003cspan style=\"color:#f92672\"\u003echildren\u003c/span\u003e:\n    \u003cspan style=\"color:#f92672\"\u003egroup1\u003c/span\u003e:\n      \u003cspan style=\"color:#f92672\"\u003ehosts\u003c/span\u003e:\n        \u003cspan style=\"color:#f92672\"\u003e192.168.149.131\u003c/span\u003e:\n  \u003cspan style=\"color:#f92672\"\u003ehosts\u003c/span\u003e:\n    \u003cspan style=\"color:#f92672\"\u003e192.168.149.133\u003c/span\u003e:\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n可以用以下指令來確認inventory\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ ansible-inventory --graph\r\n@all:\r\n  |--@group1:\r\n  |  |--192.168.149.131\r\n  |  |--192.168.149.133\r\n  |--@ungrouped:\r\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\nAnsible預設會進行ssh key checking，這裡為了方便先取消掉\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:ansible.cfg\" data-lang=\":ansible.cfg\"\u003e\n\u003cspan style=\"color:#a6e22e\"\u003e...\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003ehost_key_checking\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eFalse\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n再ping一次就成功了，因為沒有變更，所以changed會是false\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e$ ansible all -m ping\n192.168.149.131 | SUCCESS \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\n    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ansible_facts\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\n        \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;discovered_interpreter_python\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/usr/bin/python\u0026#34;\u003c/span\u003e\n    \u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e, \n    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;changed\u0026#34;\u003c/span\u003e: false, \n    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ping\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;pong\u0026#34;\u003c/span\u003e\n\u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e\n192.168.149.133 | SUCCESS \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\n    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ansible_facts\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\n        \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;discovered_interpreter_python\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/usr/bin/python\u0026#34;\u003c/span\u003e\n    \u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e, \n    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;changed\u0026#34;\u003c/span\u003e: false, \n    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ping\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;pong\u0026#34;\u003c/span\u003e\n\u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n不用-m的話，也能用-a來讓target輸入指令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e$ ansible group1 -a \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;/bin/echo \u0026#34;hello\u0026#34;\u0026#39;\u003c/span\u003e\n192.168.149.133 | CHANGED | rc\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u0026gt;\u0026gt;\nhello\n192.168.149.131 | CHANGED | rc\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u0026gt;\u0026gt;\nhello\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003ch3 id=\"使用playbook\"\u003e使用Playbook\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n首先建立一個yaml檔，可直接指定先前的group，在指定incentory file的情況下，預設會吃ansible/hosts\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:playbook.yml\" data-lang=\":playbook.yml\"\u003e\n---\n- \u003cspan style=\"color:#f92672\"\u003ehosts\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003egroup1\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e$ ansible-playbook playbook.yml \n\nPLAY \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003egroup1\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e ******************************************************************************************************************************************************************************************************************************\n\nTASK \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eGathering Facts\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e *********************************************************************************************************************************************************************************************************************\nok: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.131\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\nok: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.133\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\nPLAY RECAP *********************************************************************************************************************************************************************************************************************************\n192.168.149.131            : ok\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e    changed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    unreachable\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    failed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    skipped\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    rescued\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    ignored\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e   \n192.168.149.133            : ok\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e    changed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    unreachable\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    failed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    skipped\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    rescued\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    ignored\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e  \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n試著定義task，使用apt module\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:playbook.yml\" data-lang=\":playbook.yml\"\u003e\n---\n- \u003cspan style=\"color:#f92672\"\u003ehosts\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003egroup1\u003c/span\u003e\n  \u003cspan style=\"color:#f92672\"\u003etasks\u003c/span\u003e:\n    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003einstall latest python3\u003c/span\u003e\n      \u003cspan style=\"color:#f92672\"\u003eapt\u003c/span\u003e:\n        \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003epython3\u003c/span\u003e\n        \u003cspan style=\"color:#f92672\"\u003estate\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003epresent\u003c/span\u003e\n        \u003cspan style=\"color:#f92672\"\u003eupdate_cache\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003eyes\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n想當然爾會遇到權限問題\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e$ ansible-playbook playbook.yml\n\nPLAY \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003egroup1\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e ******************************************************************************************************************************************************************************************************************************\n\nTASK \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eGathering Facts\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e *********************************************************************************************************************************************************************************************************************\nok: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.133\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\nok: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.131\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\nTASK \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003einstall latest python3\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e ***************************************************************************************************************************************************************************************************************\n\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eWARNING\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e: Updating cache and auto-installing missing dependency: python-apt\nfatal: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.131\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e: FAILED! \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;changed\u0026#34;\u003c/span\u003e: false, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cmd\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;apt-get update\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;msg\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;E: Could not open lock file /var/lib/apt/lists/lock - open (13: Permission denied)\\nE: Unable to lock directory /var/lib/apt/lists/\\nW: Problem unlinking the file /var/cache/apt/pkgcache.bin - RemoveCaches (13: Permission denied)\\nW: Problem unlinking the file /var/cache/apt/srcpkgcache.bin - RemoveCaches (13: Permission denied)\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;rc\u0026#34;\u003c/span\u003e: 100, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;stderr\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;E: Could not open lock file /var/lib/apt/lists/lock - open (13: Permission denied)\\nE: Unable to lock directory /var/lib/apt/lists/\\nW: Problem unlinking the file /var/cache/apt/pkgcache.bin - RemoveCaches (13: Permission denied)\\nW: Problem unlinking the file /var/cache/apt/srcpkgcache.bin - RemoveCaches (13: Permission denied)\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;stderr_lines\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;E: Could not open lock file /var/lib/apt/lists/lock - open (13: Permission denied)\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;E: Unable to lock directory /var/lib/apt/lists/\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;W: Problem unlinking the file /var/cache/apt/pkgcache.bin - RemoveCaches (13: Permission denied)\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;W: Problem unlinking the file /var/cache/apt/srcpkgcache.bin - RemoveCaches (13: Permission denied)\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;stdout\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Reading package lists...\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;stdout_lines\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Reading package lists...\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e]}\u003c/span\u003e\nfatal: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.133\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e: FAILED! \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;changed\u0026#34;\u003c/span\u003e: false, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cmd\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;apt-get update\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;msg\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;E: Could not open lock file /var/lib/apt/lists/lock - open (13: Permission denied)\\nE: Unable to lock directory /var/lib/apt/lists/\\nW: Problem unlinking the file /var/cache/apt/pkgcache.bin - RemoveCaches (13: Permission denied)\\nW: Problem unlinking the file /var/cache/apt/srcpkgcache.bin - RemoveCaches (13: Permission denied)\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;rc\u0026#34;\u003c/span\u003e: 100, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;stderr\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;E: Could not open lock file /var/lib/apt/lists/lock - open (13: Permission denied)\\nE: Unable to lock directory /var/lib/apt/lists/\\nW: Problem unlinking the file /var/cache/apt/pkgcache.bin - RemoveCaches (13: Permission denied)\\nW: Problem unlinking the file /var/cache/apt/srcpkgcache.bin - RemoveCaches (13: Permission denied)\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;stderr_lines\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;E: Could not open lock file /var/lib/apt/lists/lock - open (13: Permission denied)\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;E: Unable to lock directory /var/lib/apt/lists/\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;W: Problem unlinking the file /var/cache/apt/pkgcache.bin - RemoveCaches (13: Permission denied)\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;W: Problem unlinking the file /var/cache/apt/srcpkgcache.bin - RemoveCaches (13: Permission denied)\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;stdout\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Reading package lists...\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;stdout_lines\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Reading package lists...\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e]}\u003c/span\u003e\n\nPLAY RECAP *********************************************************************************************************************************************************************************************************************************\n192.168.149.131            : ok\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e    changed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    unreachable\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    failed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e    skipped\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    rescued\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    ignored\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e   \n192.168.149.133            : ok\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e    changed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    unreachable\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    failed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e    skipped\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    rescued\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    ignored\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e     \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n剛才失敗的task動作的順序原本是這樣：\u003c/p\u003e\n\u003cp\u003elogin → apt install python3\u003c/p\u003e\n\u003cp\u003e只要加了become動作會變成：\u003c/p\u003e\n\u003cp\u003elogin → sudo apt install python3\u003c/p\u003e\n\u003cp\u003e但是target是debian，預設沒有sudo，所以範例會是下列的樣子\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:playbook.yml\" data-lang=\":playbook.yml\"\u003e\n---\n- \u003cspan style=\"color:#f92672\"\u003ehosts\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003egroup1\u003c/span\u003e\n\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e  \u003cspan style=\"color:#f92672\"\u003ebecome\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003eyes\u003c/span\u003e\n\u003c/span\u003e\u003cspan style=\"display:block;width:100%;background-color:#3c3d38\"\u003e  \u003cspan style=\"color:#f92672\"\u003ebecome_method\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003esu\u003c/span\u003e\n\u003c/span\u003e  \u003cspan style=\"color:#f92672\"\u003etasks\u003c/span\u003e:\n    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003einstall latest python3\u003c/span\u003e\n      \u003cspan style=\"color:#f92672\"\u003eapt\u003c/span\u003e:\n        \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003epython3\u003c/span\u003e\n        \u003cspan style=\"color:#f92672\"\u003estate\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003epresent\u003c/span\u003e\n        \u003cspan style=\"color:#f92672\"\u003eupdate_cache\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003eyes\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n接下來就能使用playbook的task安裝python3了，記得option加上-K，輸入become password\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e$ ansible-playbook playbook.yml -K\nBECOME password: \n\nPLAY \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003egroup1\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e ******************************************************************************************************************************************************************************************************************************\n\nTASK \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eGathering Facts\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e *********************************************************************************************************************************************************************************************************************\nok: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.133\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\nok: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.131\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\nTASK \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003einstall latest python3\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e **************************************************************************************************************************************************************************************************************\nok: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.131\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\nok: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.133\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\nPLAY RECAP *********************************************************************************************************************************************************************************************************************************\n192.168.149.131            : ok\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e    changed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    unreachable\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    failed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    skipped\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    rescued\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    ignored\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e   \n192.168.149.133            : ok\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e    changed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    unreachable\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    failed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    skipped\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    rescued\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    ignored\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e  \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003ch3 id=\"建立role\"\u003e建立Role\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n接下來就是建立role了，role裡面可以包含許多task，方便整理\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ mkdir -p roles/common/tasks\r\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n既然要重複使用role，想必一定要有判斷作業系統設定比較合理，常見的像是RPM-Based和DEB-Based，在安裝時就需要yum跟apt不同module，\n這次練習就依照這情境，建立測試用的task，分別是main.yml、redhat.yml、debian.yml\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:roles/common/tasks/main.yml\" data-lang=\":roles/common/tasks/main.yml\"\u003e\n- \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003etest os\u003c/span\u003e\n  \u003cspan style=\"color:#f92672\"\u003eimport_tasks\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eredhat.yml\u003c/span\u003e\n  \u003cspan style=\"color:#f92672\"\u003ewhen\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eansible_facts[\u0026#39;os_family\u0026#39;]|lower == \u0026#39;redhat\u0026#39;\u003c/span\u003e\n- \u003cspan style=\"color:#f92672\"\u003eimport_tasks\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003edebian.yml\u003c/span\u003e\n  \u003cspan style=\"color:#f92672\"\u003ewhen\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eansible_facts[\u0026#39;os_family\u0026#39;]|lower == \u0026#39;debian\u0026#39;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:roles/common/tasks/redhat.yml\" data-lang=\":roles/common/tasks/redhat.yml\"\u003e\n- \u003cspan style=\"color:#f92672\"\u003eshell\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eecho \u0026#39;I am redhat\u0026#39;\u003c/span\u003e\n  \u003cspan style=\"color:#f92672\"\u003eregister\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eshell_result\u003c/span\u003e\n- \u003cspan style=\"color:#f92672\"\u003edebug\u003c/span\u003e:\n    \u003cspan style=\"color:#f92672\"\u003evar\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eshell_result.stdout_lines\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:roles/common/tasks/debian.yml\" data-lang=\":roles/common/tasks/debian.yml\"\u003e\n- \u003cspan style=\"color:#f92672\"\u003eshell\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eecho \u0026#39;I am debian\u0026#39;\u003c/span\u003e\n  \u003cspan style=\"color:#f92672\"\u003eregister\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eshell_result\u003c/span\u003e\n- \u003cspan style=\"color:#f92672\"\u003edebug\u003c/span\u003e:\n    \u003cspan style=\"color:#f92672\"\u003evar\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eshell_result.stdout_lines\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e使用shell module，用debug來收回stdout\n\u003cbr\u003e\u003c/br\u003e\n目錄的樹狀圖會是這樣\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e.\r\n├── playbook.yml\r\n└── roles\r\n    └── common\r\n        └── tasks\r\n            ├── debian.yml\r\n            ├── main.yml\r\n            └── redhat.yml\r\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n接著變更inventory，加上group2，內有一台centos\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-yml\" data-lang=\"yml\"\u003e\u003cspan style=\"color:#f92672\"\u003eall\u003c/span\u003e:\n  \u003cspan style=\"color:#f92672\"\u003echildren\u003c/span\u003e:\n    \u003cspan style=\"color:#f92672\"\u003egroup1\u003c/span\u003e:\n      \u003cspan style=\"color:#f92672\"\u003ehosts\u003c/span\u003e:\n        \u003cspan style=\"color:#f92672\"\u003e192.168.149.131\u003c/span\u003e:\n        \u003cspan style=\"color:#f92672\"\u003e192.168.149.133\u003c/span\u003e:\n      \u003cspan style=\"color:#f92672\"\u003evars\u003c/span\u003e:\n        \u003cspan style=\"color:#f92672\"\u003eansible_user\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eqaz\u003c/span\u003e\n        \u003cspan style=\"color:#f92672\"\u003eansible_password\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e123\u003c/span\u003e\n        \u003cspan style=\"color:#f92672\"\u003eansible_python_interpreter\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eauto_legacy_silent\u003c/span\u003e\n\n    \u003cspan style=\"color:#f92672\"\u003egroup2\u003c/span\u003e:\n      \u003cspan style=\"color:#f92672\"\u003ehosts\u003c/span\u003e:\n        \u003cspan style=\"color:#f92672\"\u003e192.168.149.132\u003c/span\u003e:\n      \u003cspan style=\"color:#f92672\"\u003evars\u003c/span\u003e:\n        \u003cspan style=\"color:#f92672\"\u003eansible_user\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eroot\u003c/span\u003e\n        \u003cspan style=\"color:#f92672\"\u003eansible_password\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e123\u003c/span\u003e\n        \u003cspan style=\"color:#f92672\"\u003eansible_python_interpreter\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eauto_legacy_silent\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\nplaybook增加剛才的group，兩個group的role同為common\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-:playbook.yml\" data-lang=\":playbook.yml\"\u003e\n---\n- \u003cspan style=\"color:#f92672\"\u003ehosts\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003egroup1\u003c/span\u003e\n  \u003cspan style=\"color:#f92672\"\u003ebecome\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003eyes\u003c/span\u003e\n  \u003cspan style=\"color:#f92672\"\u003ebecome_method\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003esu\u003c/span\u003e\n  \u003cspan style=\"color:#f92672\"\u003eroles\u003c/span\u003e:\n    - \u003cspan style=\"color:#ae81ff\"\u003ecommon\u003c/span\u003e\n\n- \u003cspan style=\"color:#f92672\"\u003ehosts\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003egroup2\u003c/span\u003e\n  \u003cspan style=\"color:#f92672\"\u003eroles\u003c/span\u003e:\n    - \u003cspan style=\"color:#ae81ff\"\u003ecommon\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n這樣輸出的畫面就是這樣，顯而易見兩者echo的是不同的string，這樣基礎練習就到此為止收工啦\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e$ ansible-playbook playbook.yml -K\nBECOME password: \n\nPLAY \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003egroup1\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e ******************************************************************************************************************************************************************************************************************************\n\nTASK \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eGathering Facts\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e *********************************************************************************************************************************************************************************************************************\nok: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.133\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\nok: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.131\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\nTASK \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ecommon : shell\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e **********************************************************************************************************************************************************************************************************************\nskipping: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.133\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\nskipping: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.131\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\nTASK \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ecommon : debug\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e **********************************************************************************************************************************************************************************************************************\nskipping: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.133\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\nskipping: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.131\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\nTASK \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ecommon : shell\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e **********************************************************************************************************************************************************************************************************************\nchanged: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.131\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\nchanged: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.133\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\nTASK \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ecommon : debug\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e **********************************************************************************************************************************************************************************************************************\nok: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.133\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\n    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;shell_result.stdout_lines\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\n        \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;I am debian\u0026#34;\u003c/span\u003e\n    \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e\nok: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.131\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\n    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;shell_result.stdout_lines\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\n        \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;I am debian\u0026#34;\u003c/span\u003e\n    \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e\n\nPLAY \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003egroup2\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e ******************************************************************************************************************************************************************************************************************************\n\nTASK \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eGathering Facts\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e *********************************************************************************************************************************************************************************************************************\nok: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.132\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\nTASK \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ecommon : shell\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e **********************************************************************************************************************************************************************************************************************\nchanged: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.132\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\nTASK \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ecommon : debug\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e **********************************************************************************************************************************************************************************************************************\nok: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.132\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\n    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;shell_result.stdout_lines\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\n        \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;I am redhat\u0026#34;\u003c/span\u003e\n    \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e\n\nTASK \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ecommon : shell\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e **********************************************************************************************************************************************************************************************************************\nskipping: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.132\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\nTASK \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ecommon : debug\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e **********************************************************************************************************************************************************************************************************************\nskipping: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e192.168.149.132\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\nPLAY RECAP *********************************************************************************************************************************************************************************************************************************\n192.168.149.131            : ok\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e    changed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e    unreachable\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    failed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    skipped\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e    rescued\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    ignored\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e   \n192.168.149.132            : ok\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e    changed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e    unreachable\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    failed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    skipped\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e    rescued\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    ignored\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e   \n192.168.149.133            : ok\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e    changed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e    unreachable\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    failed\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    skipped\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e    rescued\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    ignored\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e   \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e",
    "kind": "page",
    "params": {
      "categories": [
        "Operation"
      ],
      "date": "2020-09-01T16:49:15+08:00",
      "draft": false,
      "iscjklanguage": true,
      "lastmod": "2020-09-01T16:49:15+08:00",
      "publishdate": "2020-09-01T16:49:15+08:00",
      "tags": [
        "Ansible"
      ],
      "title": "從今天開始學Ansible"
    },
    "permalink": "https://mikanbearer.github.io/posts/2020/09/202009011649/index.json",
    "type": "posts",
    "wordcount": 2086
  }
}