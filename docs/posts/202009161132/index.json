



    
        
    




{
  "result": {
    "content": "\u003cp\u003e身為資料分析\u0026amp;機器學習的超級新手，個人還是覺得實際操作一遍比理論更好理解，\n這次練習的是之前曾草草帶過的機械學習工具scikit-learn，主題就決定是決策樹了\u003c/p\u003e\n\u003cp\u003e首先要提一下決策樹，決策樹顧名思義是一種樹形結構，利用層層推理來進行數據的分類，決策樹的構成可分為：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e根節點(root node)： 全部的數據樣本\u003c/li\u003e\n\u003cli\u003e內部節點(internal node)： 對應的特徵屬性測試\u003c/li\u003e\n\u003cli\u003e葉節點(leaf node)： 決策的結果\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n以下圖範例來看的話，A就是根節點，C、D、E則是葉節點，剩餘的B就是內部節點\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"3.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e本次練習的參考資料：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://qiita.com/3000manJPY/items/ef7495960f472ec14377\"\u003ehttps://qiita.com/3000manJPY/items/ef7495960f472ec14377\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://qiita.com/Hawaii/items/53efe3e96b1171ebc7db\"\u003ehttps://qiita.com/Hawaii/items/53efe3e96b1171ebc7db\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n做好的結果也可直接觀看\u003ca href=\"https://github.com/mikanbearer/experiments/blob/master/tree.ipynb\"\u003ehttps://github.com/mikanbearer/experiments/blob/master/tree.ipynb\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003ch3 id=\"載入測試用的資料集\"\u003e載入測試用的資料集\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\nscikit-learn提供了很多練習用的資料集方便練習，這次練習使用load_wine()，可以從DESCR查看詳細資料\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-py\" data-lang=\"py\"\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e sklearn \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e datasets\n\n\nwine \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e datasets\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eload_wine()\n\n\u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(wine\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ekeys())\n\u003cspan style=\"color:#75715e\"\u003e#dict_keys([\u0026#39;data\u0026#39;, \u0026#39;target\u0026#39;, \u0026#39;frame\u0026#39;, \u0026#39;target_names\u0026#39;, \u0026#39;DESCR\u0026#39;, \u0026#39;feature_names\u0026#39;])\u003c/span\u003e\n\n\u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(wine\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDESCR)\n\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e.. _wine_dataset:\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eWine recognition dataset\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e------------------------\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e**Data Set Characteristics:**\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    :Number of Instances: 178 (50 in each of three classes)\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    :Number of Attributes: 13 numeric, predictive attributes and the class\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    :Attribute Information:\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e \t\t- Alcohol\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e \t\t- Malic acid\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e \t\t- Ash\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\t\t- Alcalinity of ash  \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e \t\t- Magnesium\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\t\t- Total phenols\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e \t\t- Flavanoids\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e \t\t- Nonflavanoid phenols\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e \t\t- Proanthocyanins\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\t\t- Color intensity\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e \t\t- Hue\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e \t\t- OD280/OD315 of diluted wines\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e \t\t- Proline\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    - class:\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e            - class_0\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e            - class_1\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e            - class_2\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\t\t\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    :Summary Statistics:\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    ============================= ==== ===== ======= =====\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e                                   Min   Max   Mean     SD\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    ============================= ==== ===== ======= =====\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    Alcohol:                      11.0  14.8    13.0   0.8\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    Malic Acid:                   0.74  5.80    2.34  1.12\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    Ash:                          1.36  3.23    2.36  0.27\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    Alcalinity of Ash:            10.6  30.0    19.5   3.3\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    Magnesium:                    70.0 162.0    99.7  14.3\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    Total Phenols:                0.98  3.88    2.29  0.63\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    Flavanoids:                   0.34  5.08    2.03  1.00\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    Nonflavanoid Phenols:         0.13  0.66    0.36  0.12\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    Proanthocyanins:              0.41  3.58    1.59  0.57\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    Colour Intensity:              1.3  13.0     5.1   2.3\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    Hue:                          0.48  1.71    0.96  0.23\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    OD280/OD315 of diluted wines: 1.27  4.00    2.61  0.71\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    Proline:                       278  1680     746   315\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    ============================= ==== ===== ======= =====\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    :Missing Attribute Values: None\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    :Class Distribution: class_0 (59), class_1 (71), class_2 (48)\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    :Creator: R.A. Fisher\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    :Donor: Michael Marshall (MARSHALL%PLU@io.arc.nasa.gov)\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e    :Date: July, 1988\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eThis is a copy of UCI ML Wine recognition datasets.\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003ehttps://archive.ics.uci.edu/ml/machine-learning-databases/wine/wine.data\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eThe data is the results of a chemical analysis of wines grown in the same\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eregion in Italy by three different cultivators. There are thirteen different\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003emeasurements taken for different constituents found in the three types of\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003ewine.\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eOriginal Owners: \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eForina, M. et al, PARVUS - \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eAn Extendible Package for Data Exploration, Classification and Correlation. \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eInstitute of Pharmaceutical and Food Analysis and Technologies,\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eVia Brigata Salerno, 16147 Genoa, Italy.\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eCitation:\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eLichman, M. (2013). UCI Machine Learning Repository\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e[https://archive.ics.uci.edu/ml]. Irvine, CA: University of California,\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eSchool of Information and Computer Science. \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e.. topic:: References\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e  (1) S. Aeberhard, D. Coomans and O. de Vel, \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e  Comparison of Classifiers in High Dimensional Settings, \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e  Tech. Rep. no. 92-02, (1992), Dept. of Computer Science and Dept. of  \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e  Mathematics and Statistics, James Cook University of North Queensland. \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e  (Also submitted to Technometrics). \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e  The data was used with many others for comparing various \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e  classifiers. The classes are separable, though only RDA \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e  has achieved 100\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e% c\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eorrect classification. \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e  (RDA : 100%, QDA 99.4%, LDA 98.9%, 1NN 96.1% (z-transformed data)) \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e  (All results using the leave-one-out technique) \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e  (2) S. Aeberhard, D. Coomans and O. de Vel, \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e  \u0026#34;THE CLASSIFICATION PERFORMANCE OF RDA\u0026#34; \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e  Tech. Rep. no. 92-01, (1992), Dept. of Computer Science and Dept. of \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e  Mathematics and Statistics, James Cook University of North Queensland. \n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e  (Also submitted to Journal of Chemometrics).\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n為了方便練習，用pandas做成DataFrame\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-py\" data-lang=\"py\"\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e pandas \u003cspan style=\"color:#f92672\"\u003eas\u003c/span\u003e pd\n\n\nwine_data \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDataFrame(data\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ewine\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edata, columns\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ewine\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003efeature_names)\n\u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(wine_data\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehead())\n\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e   alcohol  malic_acid   ash  ...   hue  od280/od315_of_diluted_wines  proline\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e0    14.23        1.71  2.43  ...  1.04                          3.92   1065.0\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1    13.20        1.78  2.14  ...  1.05                          3.40   1050.0\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e2    13.16        2.36  2.67  ...  1.03                          3.17   1185.0\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e3    14.37        1.95  2.50  ...  0.86                          3.45   1480.0\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e4    13.24        2.59  2.87  ...  1.04                          2.93    735.0\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e[5 rows x 13 columns]\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\n\nwine_target \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDataFrame(data\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ewine\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etarget)\n\u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(wine_target\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehead())\n\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e   0\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e0  0\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1  0\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e2  0\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e3  0\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e4  0\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\n\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003ch3 id=\"分割訓練集與測試集\"\u003e分割訓練集與測試集\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n在這裡利用train_test_split分割出\u0026quot;訓練集(training set)\u0026ldquo;與\u0026quot;測試集(test set)\u0026quot;，訓練集是模型擬合用的樣本資料，而測試集則是預留下來對結果進行評價\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-py\" data-lang=\"py\"\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e sklearn.model_selection \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e train_test_split\n\n\nx_train, x_test, y_train, y_test \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e train_test_split(wine_data, wine_target, test_size\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0.3\u003c/span\u003e)\n\n\u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(wine_data\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eshape)\n\u003cspan style=\"color:#75715e\"\u003e#(178, 13)\u003c/span\u003e\n\u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(x_train\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eshape)\n\u003cspan style=\"color:#75715e\"\u003e#(124, 13)\u003c/span\u003e\n\u003cspan style=\"color:#66d9ef\"\u003eprint\u003c/span\u003e(x_test\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eshape)\n\u003cspan style=\"color:#75715e\"\u003e#(54, 13)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003ch3 id=\"實施訓練\"\u003e實施訓練\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n這個DecisionTreeClassifier就是咱們的分類器，要使用剛才的資料來訓練模型，就把剛才分出來的訓練集往分類器裡面丟，當然也可以是資料的狀況設定max_depth或max_leaf_nodes，這樣決策樹就完成了，能使用plot_tree()來看看訓練的結果\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-py\" data-lang=\"py\"\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e sklearn.tree \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e DecisionTreeClassifier, plot_tree\n\n\nclf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e DecisionTreeClassifier()\nclf\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003efit(x_train, y_train)\n\nplot_tree(clf)\n\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e[Text(136.96363636363637, 195.696, \u0026#39;X[9] \u0026lt;= 3.82\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003egini = 0.657\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esamples = 124\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003evalue = [39, 51, 34]\u0026#39;),\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e Text(60.872727272727275, 152.208, \u0026#39;X[11] \u0026lt;= 3.73\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003egini = 0.087\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esamples = 44\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003evalue = [2, 42, 0]\u0026#39;),\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e Text(30.436363636363637, 108.72, \u0026#39;gini = 0.0\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esamples = 42\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003evalue = [0, 42, 0]\u0026#39;),\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e Text(91.30909090909091, 108.72, \u0026#39;gini = 0.0\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esamples = 2\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003evalue = [2, 0, 0]\u0026#39;),\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e Text(213.05454545454546, 152.208, \u0026#39;X[11] \u0026lt;= 2.475\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003egini = 0.593\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esamples = 80\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003evalue = [37, 9, 34]\u0026#39;),\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e Text(152.1818181818182, 108.72, \u0026#39;X[10] \u0026lt;= 0.97\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003egini = 0.056\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esamples = 35\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003evalue = [0, 1, 34]\u0026#39;),\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e Text(121.74545454545455, 65.232, \u0026#39;gini = 0.0\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esamples = 34\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003evalue = [0, 0, 34]\u0026#39;),\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e Text(182.61818181818182, 65.232, \u0026#39;gini = 0.0\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esamples = 1\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003evalue = [0, 1, 0]\u0026#39;),\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e Text(273.92727272727274, 108.72, \u0026#39;X[12] \u0026lt;= 724.5\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003egini = 0.292\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esamples = 45\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003evalue = [37, 8, 0]\u0026#39;),\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e Text(243.4909090909091, 65.232, \u0026#39;X[1] \u0026lt;= 3.015\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003egini = 0.198\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esamples = 9\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003evalue = [1, 8, 0]\u0026#39;),\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e Text(213.05454545454546, 21.744, \u0026#39;gini = 0.0\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esamples = 8\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003evalue = [0, 8, 0]\u0026#39;),\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e Text(273.92727272727274, 21.744, \u0026#39;gini = 0.0\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esamples = 1\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003evalue = [1, 0, 0]\u0026#39;),\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e Text(304.3636363636364, 65.232, \u0026#39;gini = 0.0\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esamples = 36\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003evalue = [36, 0, 0]\u0026#39;)]\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg src=\"0.png\" alt=\"\"\u003e\n\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003ch3 id=\"繪製決策樹\"\u003e繪製決策樹\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n前面的小樹實在慘不忍睹，這裡就用graphviz來將決策樹繪製出來\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-py\" data-lang=\"py\"\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e pydotplus\n\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e IPython.display \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e Image\n\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e sklearn.tree \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e export_graphviz\n\n\ndot_data \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e export_graphviz(\n    clf,\n    out_file\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eNone,\n    feature_names\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ewine\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003efeature_names,\n    class_names\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ewine\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etarget_names,\n    filled\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eTrue,\n    proportion\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eTrue)\ngraph \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pydotplus\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egraph_from_dot_data(dot_data)\nImage(graph\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecreate_png())\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg src=\"1.png\" alt=\"\"\u003e\n\u003cbr\u003e\u003c/br\u003e\u003c/p\u003e\n\u003ch3 id=\"評價\"\u003e評價\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cbr\u003e\u003c/br\u003e\n經過決策樹分歧產生的預測和測試集中的實際資料對比\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-py\" data-lang=\"py\"\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e sklearn.metrics \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e confusion_matrix\n\n\ndf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDataFrame(confusion_matrix(y_test,clf\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epredict(x_test)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereshape(\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)))\ndf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003erename(columns\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003edict(zip(df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecolumns, [\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;(pre) \u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e name \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e name \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e wine\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etarget_names])), index\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003edict(zip(df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecolumns, wine\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etarget_names)))\ndf\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg src=\"2.png\" alt=\"\"\u003e\n\u003cbr\u003e\u003c/br\u003e\n算出評分，這次勉強還行，因為神經網路的隨機性，有時還會只有0.8左右\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-py\" data-lang=\"py\"\u003eclf\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003escore(x_test,y_test)\n\n\u003cspan style=\"color:#75715e\"\u003e#0.9444444444444444\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e",
    "kind": "page",
    "params": {
      "categories": [
        "MachineLearning"
      ],
      "date": "2020-09-16T11:32:49+08:00",
      "draft": false,
      "iscjklanguage": true,
      "lastmod": "2020-09-16T11:32:49+08:00",
      "publishdate": "2020-09-16T11:32:49+08:00",
      "tags": [
        "Python",
        "scikit-learn"
      ],
      "title": "scikit-learn新手入門之決策樹篇"
    },
    "permalink": "https://mikanbearer.github.io/posts/202009161132/index.json",
    "type": "posts",
    "wordcount": 1531
  }
}